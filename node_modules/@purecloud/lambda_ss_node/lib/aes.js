"use strict"
const crypto = require('crypto');

function aesDecrypt (cryptkey, iv, encrypteddata){

    encrypteddata = new Buffer(encrypteddata, 'base64');
    var decipher = crypto.createDecipheriv('aes-256-cbc', cryptkey, iv);

    let decoded = decipher.update(encrypteddata, 'hex', 'utf8');
    decoded += decipher.final('utf8');

    return decoded;

}

module.exports = {
    decrypt: aesDecrypt
}
