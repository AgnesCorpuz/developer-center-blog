"use strict"

var assert = require('assert');

var aes = require ('../lib/aes');

describe('AES Decryption', function() {

    it('should be able to decrypt the string', function() {
        let encryptedValue = 'RGi93dACBokIluYLRF5vd5mSAW5nybivjw2G2WMYpNu2jedvQWCKuNejglpzYl4COHl43TQzs1FhKELfP5DiRxptlgLArbBPGeye6SOFewI=';
        let key = new Buffer('15b6a6ced04a1cfc1c8fc60892d9aa489d0b9feb9bc18aadaa7005c05c16b1c3', 'hex');
        let iv = new Buffer('5FBxZ4gTS6gFe9ozYptDzQ==', 'base64');

        let base64Decoded = new Buffer(encryptedValue, 'base64');

        let decrypted = aes.decrypt(key, iv, base64Decoded);
        assert.equal('{"username":"test_username","password":"test_password"}', JSON.stringify(JSON.parse(decrypted)));
    });
});
